# Windows 截图工具

基于 PyQt5 开发的桌面截屏与标注工具，提供区域框选、自动保存、矩形/圆点标注，以及可扩展的全局热键和面板式导航界面。

## 安装

1. 建议使用 Python 3.9+。
2. 安装依赖：

```bash
pip install -r requirements.txt
```

## 使用

```bash
python screenshot_tool.py
```

- 左侧导航栏仿 PicPick 风格；主页展示“新任务 / 截取屏幕 / 实用工具”三个分区。
- “区域截图”会隐藏主窗体、展示全屏遮罩，拖曳鼠标即可截取；松开后进入标注窗口（矩形高亮、顺序圆点、自动与手动保存）。
- “重复上次截取”会沿用最近一次区域，方便批量输出。
- “系统设置”弹窗中可以录制全局热键，底部“保存设置”后即写入配置并注册到系统。
- 截图与标注文件默认保存到 `screenshots/`，可以在主页顶部卡片里更改或直接打开文件夹。

## 全局热键

- 热键录制窗口接受任意组合键（Ctrl / Shift / Alt / Win + 字母/数字/功能键等）；
- 程序使用 Windows 的 `RegisterHotKey` 接口注册快捷键，无需额外模块，也不强制管理员权限；
- 注册失败时会弹出提示（常见于组合被其他程序占用），更换组合或以管理员身份运行即可。

## 目录结构

- `screenshot_tool.py`：主程序，包含截屏、标注、首页 UI、系统设置与热键逻辑。
- `screenshots/`：默认自动保存目录，可在 UI 内修改。
- `favicon/`：自定义应用图标（标准 ICO 与多尺寸 PNG），在桌面和对话框中统一使用。

## 备注

- 每次截屏都会自动保存原图，若另存含标注版本会在文件名后附加 `_annotated`。
- 界面和说明文本全部使用 UTF-8 编码，若在 PowerShell 中出现乱码可切换到 UTF-8 控制台或使用 VS Code 打开。
